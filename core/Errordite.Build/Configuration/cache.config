<?xml version="1.0"?>
<configuration>
  <properties>
    <defaultCacheEngine>${redis-memory-hybrid}</defaultCacheEngine>
  </properties>
  <components>

    <component id="RedisConfiguration"
           lifestyle="singleton"
           service="CodeTrip.Core.Redis.RedisConfiguration, CodeTrip.Core"
           type="CodeTrip.Core.Redis.RedisConfiguration, CodeTrip.Core">
      <parameters>
        <Endpoint>127.0.0.1</Endpoint>
        <Port>6379</Port>
      </parameters>
    </component>
    
    <component id="redis"
               lifestyle="singleton"
               service="CodeTrip.Core.Caching.Interfaces.ICacheEngine, CodeTrip.Core"
               type="CodeTrip.Core.Caching.Engines.RedisCacheEngine, CodeTrip.Core">
      <parameters>
        <session>${redisSession}</session>
      </parameters>
    </component>

    <component id="redis-memory-hybrid"
               lifestyle="singleton"
               service="CodeTrip.Core.Caching.Interfaces.ICacheEngine, CodeTrip.Core"
               type="CodeTrip.Core.Caching.Engines.RedisMemoryHybridCacheEngine, CodeTrip.Core">
      <parameters>
        <memoryCache>${memory}</memoryCache>
        <redisCache>${redis}</redisCache>
      </parameters>
    </component>

    <component id="memory"
               lifestyle="singleton"
               service="CodeTrip.Core.Caching.Interfaces.ICacheEngine, CodeTrip.Core"
               type="CodeTrip.Core.Caching.Engines.MemoryCacheEngine, CodeTrip.Core">
    </component>

    <component id="RedisSession"
           lifestyle="singleton"
           service="CodeTrip.Core.Redis.IRedisSession, CodeTrip.Core"
           type="CodeTrip.Core.Redis.RedisSession, CodeTrip.Core">
      <parameters>
        <redisConfiguration>${RedisConfiguration}</redisConfiguration>
      </parameters>
    </component>
    
    <component id="CacheConfiguration"
           lifestyle="singleton"
           service="CodeTrip.Core.Caching.Entities.ICacheConfiguration, CodeTrip.Core"
           type="CodeTrip.Core.Caching.Entities.CacheConfiguration, CodeTrip.Core">
      <parameters>
        <cacheProfiles>
          <dictionary>
            <entry key="users">${UserCache}</entry>
            <entry key="groups">${GroupCache}</entry>
            <entry key="applications">${ApplicationCache}</entry>
            <entry key="organisations">${OrganisationCache}</entry>
            <entry key="system">${SystemCache}</entry>
            <entry key="dashboard">${DashboardCache}</entry>
          </dictionary>
        </cacheProfiles>
      </parameters>
    </component>

    <component id="SystemCache"
               lifestyle="singleton"
               service="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core"
               type="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core">
      <parameters>
        <cacheId>1</cacheId>
        <profileName>system</profileName>
        <engine>#{defaultCacheEngine}</engine>
      </parameters>
    </component>

    <component id="UserCache"
               lifestyle="singleton"
               service="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core"
               type="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core">
      <parameters>
        <cacheId>2</cacheId>
        <profileName>users</profileName>
        <engine>#{defaultCacheEngine}</engine>
        <timeout>01:00:00</timeout>
      </parameters>
    </component>

    <component id="GroupCache"
               lifestyle="singleton"
               service="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core"
               type="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core">
      <parameters>
        <cacheId>3</cacheId>
        <profileName>groups</profileName>
        <engine>#{defaultCacheEngine}</engine>
        <timeout>01:00:00</timeout>
      </parameters>
    </component>

    <component id="ApplicationCache"
               lifestyle="singleton"
               service="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core"
               type="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core">
      <parameters>
        <cacheId>4</cacheId>
        <profileName>applications</profileName>
        <engine>#{defaultCacheEngine}</engine>
        <timeout>01:00:00</timeout>
      </parameters>
    </component>

    <component id="OrganisationCache"
               lifestyle="singleton"
               service="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core"
               type="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core">
      <parameters>
        <cacheId>5</cacheId>
        <profileName>organisations</profileName>
        <engine>#{defaultCacheEngine}</engine>
        <timeout>01:00:00</timeout>
      </parameters>
    </component>

      <component id="DashboardCache"
                 lifestyle="singleton"
                 service="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core"
                 type="CodeTrip.Core.Caching.Entities.CacheProfile, CodeTrip.Core">
          <parameters>
              <cacheId>6</cacheId>
              <profileName>dashboard</profileName>
              <engine>#{defaultCacheEngine}</engine>
              <timeout>00:05:00</timeout>
          </parameters>
      </component>

  </components>
</configuration>
