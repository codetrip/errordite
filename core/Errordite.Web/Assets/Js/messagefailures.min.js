(function(){jQuery(function(){var a,c,b;a=$("section#monitoring");if(a.length>0){a.delegate("a.purge","click",function(f){var d;f.preventDefault();d=$(this);if(!confirm("Are you sure you want to delete all messages?")){return false}return b.deleteMessages(d.data("service"))});a.delegate("a.retry","click",function(f){var d;f.preventDefault();d=$(this);if(!confirm("Are you sure you want to retry all messages?")){return false}return b.returnToSource(d.data("service"))});a.delegate("select#RavenInstanceId","change",function(f){var d;f.preventDefault();d=$(this);return b.switchInstance(d.val())});a.delegate("a#refresh","click",function(d){d.preventDefault();return b.reload()});a.delegate("a.start-service","click",function(f){var d;f.preventDefault();d=$(this);return b.serviceControl(d.data("service"),d.data("start"))});c=(function(){function d(){}d.prototype.deleteMessages=function(){var e;e=function(f){};$.ajax({url:"/system/services/deletemessages",data:{instanceId:$("select#RavenInstanceId").val(),serviceName:serviceName},success:function(f){if(f.success){location.reload()}else{return Errordite.Alert.show("Failed to delete messages, please try again.")}return true},error:function(){return alert("Failed to delete messages, please try again.")},dataType:"json",type:"POST"});return true};d.prototype.returnToSource=function(e){$.ajax({url:"/system/services/returntosource",data:{instanceId:$("select#RavenInstanceId").val(),serviceName:e},success:function(f){if(f.success){location.reload()}else{Errordite.Alert.show("Failed to return error messages to their source queue, please try again.")}return true},error:function(){return Errordite.Alert.show("Failed to return error messages to their source queue, please try again.")},dataType:"json",type:"POST"});return true};d.prototype.reload=function(){window.location="/system/services?ravenInstanceId="+$("select#RavenInstanceId").val();return true};d.prototype.switchInstance=function(e){window.location="/system/services?ravenInstanceId="+e;return true};d.prototype.serviceControl=function(e,f){$.ajax({url:"/system/services/servicecontrol",data:{serviceName:e,start:f},success:function(g){if(g.success){return location.reload()}else{Errordite.Alert.show("Service failed to "+(f!=null?f:{start:"stop"})+", please try again.")}return true},error:function(){return Errordite.Alert.show("Service failed to "+(f!=null?f:{start:"stop"})+", please try again.")},dataType:"json",type:"POST"});return true};return d})();b=new c();return true}})}).call(this);