
@using Errordite.Web.Extensions
@using Errordite.Web.Models.Dashboard
@model DashboardViewModel
           
@{
    ViewBag.Title = "Dashboard";
}

<section id="dashboard" class="centered">
    <div class="content">
        @Html.HiddenFor(m => m.LastErrorDisplayed)
        @Html.HiddenFor(m => m.LastIssueDisplayed)
        @if (Model.SingleApplicationId != null && Model.Stats.Issues < 3)
        {
            <h1>Welcome to Errordite</h1>
            <div class="two-col">
                <div class="small-padding right">
                    <p>
                        This is your dashboard, where you can see the most recent issues and errors affecting your system, the issues that need your attention, and overall statistics.
                    </p>
                    <p>
                        You do not have much going on at the moment.  
                        Click @Html.ActionLink("here", "generateerror", "applications", new {applicationId = Model.SingleApplicationId, returnUrl = Url.CurrentRequest()}, new{@class="post"}) to generate a test error and get things going.
                    </p>
                </div>
            </div>
            <div class="two-col">
                <div class="small-padding right">
                    <p>
                        To get started for real download the client and configure it into your application - details @Html.ActionLink("here", "client", "help").  
                    </p>
            
                    @if (Model.SingleApplicationId != null)
                    {
                        <div class="textbox">
                            Your token is <b>@Model.SingleApplicationToken</b>
                        </div>
                    }

                    @if (Model.TestIssueId != null)
                    {
                        <p>
                            You've created a test issue - to see it, click <a href="@Url.Issue(Model.TestIssueId)">here</a>.
                        </p>
                    }
                </div>
            </div>
            <div class="clear border"></div>
        }
    
        @Html.Partial("Dashboard/Statistics", Model.Stats)

        <div class="clear border"></div>

        @if (Model.HasApplications)
        {
            <div class="two-col">
                <h2 class="section-header"><i class="icon-eye"></i>Most Recent Issues</h2>
                <div id="issues">
                    @foreach(var issue in Model.RecentIssues)
                    {
                        @Html.Partial("Dashboard/Issue", issue)
                    }
                </div>
				
            </div>
            <div class="two-col">
                <h2 class="section-header"><i class="icon-error"></i>Most Recent Errors</h2>
                <div id="errors">
                    @foreach (var error in Model.RecentErrors)
                    {
                        @Html.Partial("Dashboard/Error", error)
                    }
                </div>
            </div>
        }
        <div class="clear"></div>
    </div>
</section>


