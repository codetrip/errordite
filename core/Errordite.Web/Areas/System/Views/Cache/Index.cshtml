@using Errordite.Web.Models.Cache
@model CacheViewModel
           
@{
    ViewBag.Title = "Cache";
}

<section id="caching" class="centered">
    <div class="content">
        @if (Model.Keys.Any())
        {
            <div class="form form-inline">
                <ul>
                    <li>
                        @Html.DropDownListFor(m => m.CacheEngine, Model.Engines)
                    </li>
                    <li>
                        @using (Html.BeginForm("flush", "cache", new { cache = Model.Cache }, FormMethod.Post))
                        {
                            @Html.Hidden("cache", Model.Cache)
                            @Html.Hidden("engine", Model.CacheEngine)
                            <input type="submit" class="btn btn-small btn-blue" value="Flush Cache" />
                        }
                    </li>
                </ul>
            </div>
            <div class="clear"></div>
            <table class="table table-bordered"> 
                <thead>
                    <tr>
                        <th>Key</th>  
                        <th>Delete</th>
                    </tr>   
                </thead>  
                <tbody>
                    @foreach (var cacheKey in Model.Keys)
                    {
                        <tr>  
                            <td>@cacheKey</td>
                            <td>
                                @using (Html.BeginForm("delete", "cache", new { cache = Model.Cache }, FormMethod.Post))
                                {
                                    @Html.Hidden("CacheKey", cacheKey)
                                    @Html.Hidden("engine", Model.CacheEngine)
                                    <input type="submit" class="btn btn-small btn-blue" value="Delete" />
                                }
                            </td>             
                        </tr>
                    
                    }   
                </tbody>  
                
            </table>
        }
        else
        {
            <p>No items in the @Model.Cache cache at present.</p>
        }
    </div>
</section>