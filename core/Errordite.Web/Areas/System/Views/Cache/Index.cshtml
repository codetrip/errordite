@using Errordite.Web.Models.Cache
@model CacheViewModel
           
@{
    ViewBag.Title = "Cache";
}

@section contentHeader
{
    <div id="pagetitle">
        <h1>Cache: @Model.Cache</h1>
    </div>
    
    <div class="border"></div>
}

<div id="caching" class="colfull">
    Select Cache Engine<br />
    @Html.DropDownListFor(m => m.CacheEngine, Model.Engines)

    @if (Model.Keys.Any())
    {
        <p>
            @using (Html.BeginForm("flush", "cache", new { cache = Model.Cache }, FormMethod.Post))
            {
                @Html.Hidden("cache", Model.Cache)
                @Html.Hidden("engine", Model.CacheEngine)
                <input type="submit" class="btn btn-success" style="float:left;margin-bottom:15px;" value="Flush Cache" />
            }
        </p>
        <table class="table table-bordered"> 
            <thead>
                <tr>
                    <th>Key</th>  
                    <th>Delete</th>
                </tr>   
            </thead>  
            <tbody>
                @foreach (var cacheKey in Model.Keys)
                {
                    <tr>  
                        <td width="80%">@cacheKey</td>
                        <td>
                            @using (Html.BeginForm("delete", "cache", new { cache = Model.Cache }, FormMethod.Post))
                            {
                                @Html.Hidden("CacheKey", cacheKey)
                                @Html.Hidden("engine", Model.CacheEngine)
                                <input type="submit" class="btn btn-success" style="float:left" value="Delete" />
                            }
                        </td>             
                    </tr>
                    
                }   
            </tbody>  
                
        </table>
    }
    else
    {
        <p>No items in the @Model.Cache cache at present.</p>
    }
</div>